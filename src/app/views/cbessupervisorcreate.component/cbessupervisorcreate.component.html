<ng-container *ngIf="datafromapi == true; else loadingsuccess">
  <div>
    <section class="section_form">
      <form id="consultation-form" class="feed-form" action="#">
        <h2 class="border-3 border-dark border-bottom">จัดการหลักเกณฑ์ CBEs</h2>
        <h1 class="border-3 border-dark border-bottom">จัดการหลักเกณฑ์ CBEs</h1>
        <label for="thainame">ชื่อภาษาไทย</label>
        <input
          name="thainame"
          type="text"
          [(ngModel)]="CBEs.thaiName"
          disabled
        />
        <label for="engname">ชื่อภาษาอังกฤษ</label>
        <input name="engname" type="text" [(ngModel)]="CBEs.engName" disabled />
        <label for="shortname">ตัวย่อ</label>
        <input
          name="shortname"
          type="text"
          [(ngModel)]="CBEs.shortName"
          disabled
        />
        <div class="border-3 border-top border-bottom border-dark">
          <!-- Add Supervisor -->
          <button class="mt-2" (click)="addSupervisor()">เพิ่ม</button>
          <table style="width: 30vw" class="mt-3">
            <thead>
              <tr>
                <th>ผู้กำกับ</th>
                <th>จัดการ</th>
              </tr>
            </thead>

            <tbody>
              <tr>
                <td>
                  <select name="round">
                    <option
                      *ngFor="let supervisor of CBEs.cbeswithSupervisors"
                      [value]="supervisor"
                    >
                      {{ supervisor.position.name }}
                    </option>
                  </select>
                </td>
                <td>
                  <button class=" " (click)="deletedSubSupervisor()">ลบ</button>
                </td>
              </tr>
            </tbody>
          </table>

          <!-- Add Sub Supervisor -->
          <button (click)="addSubSupervisor()">เพิ่ม</button>
          <table style="width: 30vw" class="mt-3 mb-3">
            <thead>
              <tr>
                <th>ผู้แทน</th>
                <th>จัดการ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <select name="round">
                    <option
                      *ngFor="let supervisor of CBEs.cbeswithSupervisors"
                      [value]="supervisor"
                    >
                      {{ supervisor.position.name }}
                    </option>
                  </select>
                </td>
                <td>
                  <button class=" " (click)="deletedSubSupervisor()">ลบ</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <label for="round">รอบการแก้ไข</label>
        <select name="round">
          <option>1</option>
          <option>2</option>
          <option>3</option>
        </select>

        <label for="remark">หมายเหตุในการบันทึก</label>
        <textarea name="remark" placeholder="หมายเหตุการแก้ไข">{{
          "แก้ไข..."
        }}</textarea>
        <small>*ต้องกรอกหมายเหตุก่อนแก้ไข</small>

        <div class="mt-3 border-3 border-dark border-top">
          <div class="d-flex mt-3">
            <h3>หลักเกณฑ์</h3>
            <button class="ms-3 -sm mb-3">เพิ่มกระบวนการ</button>
          </div>

          <table>
            <thead>
              <tr>
                <th colspan="3">หลักเกณฑ์</th>
                <th>น้ำหนัก</th>
                <th colspan="3">Maturity level</th>
                <th>ผู้รับผิดชอบ</th>
              </tr>
            </thead>

            <tbody>
              <ng-container *ngFor="let process of CBEs.cbesProcesses">
                <tr *ngIf="process.isDeleted != true">
                  <td colspan="3" class="text-start ms-4 level1">level1</td>
                  <td class="level1">
                    <input
                      class="level1"
                      type="number"
                      placeholder="20"
                      style="width: 75px; text-align: center"
                      value="{{ process.weight }}"
                      disabled
                    />
                  </td>
                  <td class="level1" colspan="3"></td>
                  <td class="level1"></td>
                </tr>
              </ng-container>

              <!--  -->
              <!--  -->
              <tr>
                <td colspan="3" class="text-start ms-2">level2</td>
                <td>
                  <input
                    type="number"
                    placeholder="20"
                    style="width: 75px; text-align: center"
                    disabled
                  />
                </td>
                <td colspan="3"></td>
                <td></td>
              </tr>

              <tr>
                <td colspan="3" class="text-start ms-2">level3</td>
                <td>
                  <input
                    type="number"
                    placeholder="20"
                    style="width: 75px; text-align: center"
                    disabled
                  />
                </td>
                <td colspan="3">ระดับ 1:<textarea></textarea></td>
                <td>
                  <button>เพิ่ม</button>

                  <table style="width: 100px">
                    <thead>
                      <tr>
                        <th>ผู้รับผิดชอบ</th>
                        <th>จัดการ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <select>
                            <option>position1</option>
                            <option>position2</option>
                            <option>position3</option>
                          </select>
                        </td>
                        <td>
                          <button class=" ">ลบ</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>

              <tr>
                <td colspan="3" class="text-start ms-2"></td>
                <td></td>
                <td colspan="3">ระดับ 2:<textarea></textarea></td>
                <td>
                  <button class=" ">เพิ่ม</button>
                  <table style="width: 100px">
                    <thead>
                      <tr>
                        <td>ผู้รับผิดชอบ</td>
                        <td>จัดการ</td>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <select>
                            <option>position1</option>
                            <option>position2</option>
                            <option>position3</option>
                          </select>
                        </td>
                        <td>
                          <button class=" ">ลบ</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>

              <tr>
                <td colspan="3" class="text-start ms-2"></td>
                <td></td>
                <td colspan="3">ระดับ 3:<textarea></textarea></td>
                <td>
                  <button class=" ">เพิ่ม</button>

                  <table style="width: 100px">
                    <thead>
                      <tr>
                        <th>ผู้รับผิดชอบ</th>
                        <th>จัดการ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <select>
                            <option>position1</option>
                            <option>position2</option>
                            <option>position3</option>
                          </select>
                        </td>
                        <td>
                          <button>ลบ</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>

              <tr>
                <td colspan="3" class="text-start ms-2"></td>
                <td></td>
                <td colspan="3">ระดับ 4:<textarea></textarea></td>
                <td>
                  <button class=" ">เพิ่ม</button>

                  <table style="width: 100px">
                    <thead>
                      <tr>
                        <th>ผู้รับผิดชอบ</th>
                        <th>จัดการ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <select>
                            <option>position1</option>
                            <option>position2</option>
                            <option>position3</option>
                          </select>
                        </td>
                        <td>
                          <button>ลบ</button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>

              <tr>
                <td colspan="3" class="text-start ms-2"></td>
                <td></td>
                <td colspan="3">ระดับ 5:<textarea></textarea></td>
                <td>
                  <button class=" ">เพิ่ม</button>
                  <table style="width: 100px">
                    <thead>
                      <tr>
                        <th>ผู้รับผิดชอบ</th>
                        <th>จัดการ</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <select>
                            <option>position1</option>
                            <option>position2</option>
                            <option>position3</option>
                          </select>
                        </td>
                        <td>
                          <button
                            class=" "
                            (click)="deletedSupervisorWithMaturity()"
                          >
                            ลบ
                          </button>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="d-flex mt-3 mb-3">
            <button class="ms-3">บันทึก</button>
          </div>
        </div>
      </form>
    </section>
  </div>
</ng-container>

<ng-template #loadingsuccess>
  <loading-page></loading-page>
</ng-template>
